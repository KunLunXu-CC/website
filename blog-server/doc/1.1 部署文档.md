# 部署文档

## mongoose

- 运行镜像，启动一个容器： -v 不是必须

```shell
# --name 为容器设置名称 - e 设置环境变量 -v 挂载目录或文件（本地目录：容器目录） -p 端口映射（本地端口：远程端口） -d 以后台模式启动一个容器
# -e 命名中 "TZ=Asia/Shanghai" 设置容器时区
sudo docker run -d --name blog-mongo-4.0 -e "TZ=Asia/Shanghai" -v /home/qianyin/store/blog/mongo/db:/data/db -v /home/qianyin/store/blog/mongo/configdb:/data/configdb -p 27017:27017 mongo:4.0
```

- mongoose 在链接数据库时会自动创建数据库

## mysql

- 运行镜像，启动一个容器： -v 不是必须

```shell
# --name 为容器设置名称 - e 设置环境变量 -v 挂载目录或文件（本地目录：容器目录） -p 端口映射（本地端口：远程端口） -d 以后台模式启动一个容器
# -e 命名中 "TZ=Asia/Shanghai" 设置容器时区 MYSQL_ROOT_PASSWORD=blog 设置 mysql 密码
sudo docker run -d --name blog-mysql-8.0 -e 'TZ=Asia/Shanghai' -e MYSQL_ROOT_PASSWORD=blog -v /home/qianyin/store/blog/mysql-8.0:/var/lib/mysql -p 3306:3306 mysql:8.0
```

- mysql 不同于 mongoose 需要进入 mysql 手动创建所需的数据库

```shell
# 查看容器 id
sudo docker ps
# 进入容器
sudo docker exec -it 45d3ca6309f8 bash
# 进入mysql
mysql -uroot -pblog
# 创建新用户（user: blog password: blog）
## 补充： mysql8.0 的密码验证方式有点不同， 所以新建了一个用户并设置密码验证方式
CREATE USER 'blog'@'%' IDENTIFIED WITH mysql_native_password BY 'blog';
# 新用户设置权限
GRANT ALL PRIVILEGES ON * . * TO 'blog'@'%';
# 重新加载所有权限
FLUSH PRIVILEGES;
# 创建数据库 blog(记得加封号)
create database blog;
# 查看数据库（是否创建成功）
show databases;
# 退出(退出mysql、并退出容器)
exit
exit
```
